# UI Rules Update — 2025-09

This document consolidates recent, agreed rules for headers, shells, lists, and tiles. It aligns code with the SSOT and resolves ambiguity between `PageShell` vs. `*PageLayout` usage, title ownership, and sticky offsets.

## Headers
- Purpose: global chrome only — nav trigger (hamburger), centered title, notifications, back.
- Back vs. Hamburger: show one in the left slot, never both.
  - Top-level (e.g., `/patient`, `/pharmacy`): show hamburger (toggles/closes drawer).
  - Nested pages (lists/details): show Back; hide hamburger.
- No account controls in header. Context switch (Patient/Pharmacy) and Sign out live in sidebar footers.
- Title ownership: content view (List/Detail) owns the H1. Header never duplicates content titles.

## Page Shells (Server)
- Use:
  - `ListPageLayout` for list pages
  - `DetailPageLayout` for detail pages (view/edit/create)
  - `TilePageLayout` for tile hubs
- `PageShell` is an internal primitive; do not use directly in app pages.
- Sidebar auto-selects by route: Patient vs. Pharmacy sidebars render based on the current path.

## Sticky Offsets
- List/Detail sticky bars must account for header height: `top-14 md:top-16`.

## Lists (Client View)
- Component: `ListViewLayout` renders title + actions + table/list.
- Opt-in polish (review mode): zebra rows, subtle container, improved focus ring.
  - Prop: `previewPolish?: boolean` (default false).
  - URL: `?ui=polish` or user pref (localStorage `ui:list:polish=1`).
- A11y: single H1, `aria-sort`, visible focus; bulk-action announce via live region.

## Tiles (Client View)
- Component: `TileGridLayout`.
- Two compositions:
  - `classic`: icon left, text right (default)
  - `hero`: title on top, larger centered icon, description below
- Expressive mode: larger icon wrapper, brighter icon color, optional subtle watermark glyph.
- Props: `expressive?: boolean`, `composition?: 'classic' | 'hero'`.
- URL override: `?tiles=expressive`, `?tiles=hero` (or `?ui=polish-tiles[-hero]`).
- User Settings: `/patient/settings/ui` persists tile prefs to localStorage (`ui:tiles:*`).
- Color policy: icons are brighter than the card; cards use soft accent tints. Tiles cycle accents if none provided.
  - One icon pack (Lucide) only; no inline SVGs.

## Settings (Prototype)
- Page: `/patient/settings/ui` (Detail shell + client island).
- Controls: tiles expressive, tiles composition, list polish.
- Persistence: localStorage today; future: Zustand store + optional per-user DB prefs.

## Migration Rules
1) Move any pages using `PageShell` to the correct `*PageLayout`.
2) Remove content titles from headers; keep titles in List/Detail view layouts only.
3) Ensure sticky bars use the header offset.
4) Convert Profile to `DetailViewLayout` sections, wire `formId` for sticky Save/Cancel.
5) Remove remaining inline SVGs (e.g., Auth login social icons) in favor of components/assets.

---

References
- `components/layouts/AppHeader.tsx`: back vs hamburger logic; no user menu.
- `components/layouts/ListViewLayout.tsx`: `previewPolish` and sticky offset.
- `components/layouts/TileGridLayout.tsx`: `expressive`, `composition`, accent cycling.
- `components/layouts/*PageLayout*Client.tsx`: sidebar auto-switching by route.
- `app/patient/settings/ui/page.tsx` + `components/features/settings/UISettingsClient.tsx`: user UI prefs.

